-- PLEROMA AOE MULTI-HIT v5 â€“ HITS EVERYONE (Delta Safe via Loadstring)
-- G = Spam ALL players/NPCs | Toggle AOE/Single | Modifiable hits

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local getgc = getgc or function() return {} end

-- Find damage remote from "newRemote" upvalue
local damageRemote = nil
for _, obj in ipairs(getgc(true)) do
    if type(obj) == "function" then
        local info = debug.getinfo(obj)
        if info.name == "newRemote" then
            for i = 1, info.nups do
                local _, upval = debug.getupvalue(obj, i)
                if type(upval) == "Instance" and upval:IsA("RemoteEvent") then
                    damageRemote = upval
                    print("FOUND REMOTE: " .. upval:GetFullName())
                    break
                end
            end
        end
    end
    if damageRemote then break end
end

if not damageRemote then
    error("Attack once with weapon, then re-inject!")
end

-- Config
local hitCount = 100
local aoeMode = true

-- UI
local gui = Instance.new("ScreenGui", game.CoreGui)
local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 230, 0, 110)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1,0,0,30)
title.Text = "AOE MULTI-HIT"
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 215, 0)
title.Font = Enum.Font.GothamBold

local box = Instance.new("TextBox", frame)
box.Size = UDim2.new(1,0,0,30)
box.Position = UDim2.new(0,0,0,30)
box.Text = "100"
box.PlaceholderText = "Hits per target"
box.BackgroundColor3 = Color3.fromRGB(50,50,50)
box.TextColor3 = Color3.new(1,1,1)

local status = Instance.new("TextLabel", frame)
status.Size = UDim2.new(1,0,0,25)
status.Position = UDim2.new(0,0,0,60)
status.BackgroundTransparency = 1
status.TextColor3 = Color3.fromRGB(0,255,0)
status.Text = "Ready"

local toggle = Instance.new("TextButton", frame)
toggle.Size = UDim2.new(1,0,0,25)
toggle.Position = UDim2.new(0,0,0,85)
toggle.Text = "AOE: ON"
toggle.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
toggle.TextColor3 = Color3.new(1,1,1)

-- Update hit count
box.FocusLost:Connect(function()
    hitCount = math.max(1, tonumber(box.Text) or 100)
    status.Text = "Hits: " .. hitCount .. " | AOE: " .. (aoeMode and "ON" or "OFF")
end)

-- Toggle AOE
toggle.MouseButton1Click:Connect(function()
    aoeMode = not aoeMode
    toggle.Text = "AOE: " .. (aoeMode and "ON" or "OFF")
    toggle.BackgroundColor3 = aoeMode and Color3.fromRGB(0,150,0) or Color3.fromRGB(150,0,0)
    status.Text = "Hits: " .. hitCount .. " | AOE: " .. (aoeMode and "ON" or "OFF")
end)

-- Get all targets
local function getTargets()
    local targets = {}
    for _, plr in Players:GetPlayers() do
        if plr ~= LocalPlayer and plr.Character then
            local hum = plr.Character:FindFirstChild("Humanoid")
            local root = plr.Character:FindFirstChild("HumanoidRootPart")
            if hum and root then table.insert(targets, {hum=hum, root=root, name=plr.Name}) end
        end
    end
    for _, obj in workspace:GetDescendants() do
        if obj:IsA("Humanoid") and obj.Parent ~= LocalPlayer.Character then
            local root = obj.Parent:FindFirstChild("HumanoidRootPart")
            if root then table.insert(targets, {hum=obj, root=root, name=obj.Parent.Name}) end
        end
    end
    return targets
end

-- Spam on G
UIS.InputBegan:Connect(function(inp, proc)
    if proc or inp.KeyCode ~= Enum.KeyCode.G then return end
    status.Text = "SPAMMING " .. (aoeMode and #getTargets() .. " TARGETS..." or "SINGLE...")
    local targets = aoeMode and getTargets() or {{hum = workspace[LocalPlayer.Name.."Target"] or nil}}
    local total = 0
    for _, t in targets do
        if t.hum and t.hum.Health > 0 then
            for i = 1, hitCount do
                pcall(function()
                    damageRemote:FireServer(t.hum, 999)
                    damageRemote:FireServer(t.root, 999)
                end)
                total += 1
                if i % 15 == 0 then task.wait() end
            end
        end
    end
    status.Text = "DONE: " .. total .. " HITS | " .. #targets .. " TARGETS"
end)

print("AOE MULTI-HIT LOADED | G = SPAM ALL | TOGGLE BUTTON")
